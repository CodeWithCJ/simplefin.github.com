---
layout: default
title: SimpleFIN Protocol
last_modified: 2015-06-22
proto_version: "1.0-draft.1"
---


Last updated: {{ page.last_modified }}

Version: {{ page.proto_version }}

The SimpleFIN standard defines:

1. [SimpleFIN HTTP protocol](#simplefin-http-protocol)
2. [SimpleFIN data format](#data-format)
3. [Recommendations for token management](#recommendations)


# SimpleFIN HTTP Protocol #

## Players ##

### Institution ###

This is a bank or other institution that people have accounts with.


### SimpleFIN Server ###

An HTTP server operated by the Institution.  The SimpleFIN Server **must** require SSL for all communication with both the Account Holder and the Consumer.  Connection attempts not over SSL must be dropped -- they **must not** be redirected to SSL.


### Account Holder ###

This is a person (or business) that has an account with the Institution.



### Consumer ###

A Consumer is an application that connects to a SimpleFIN Server to retrieve financial information pertaining to an Account Holder.  The Consumer may be a hosted service or a locally-run application.  The Consumer **only** has read access to the SimpleFIN Server.  The Consumer **can not** alter the financial data on the SimpleFIN Server in any way.


## Overview ##

1. A Consumer directs an Account Holder to a SimpleFIN Server to obtain a Setup Token.

2. The Account Holder exchanges their Institution credentials for a Setup Token.

3. The Account Holder gives the Setup Token to the Consumer.

4. The Consumer stores the Setup Token.

5. The Consumer uses the Setup Token to generate an Access Token.

6. The Consumer gets financial data from the SimpleFIN Server using an Access Token.


## URLS ##

The SimpleFIN Server chooses a Root Consumer URL.  The SimpleFin Server must then implement the following standard endpoints based off of the Root Consumer URL:

### `GET /info` ###

Requests to this endpoint require **no authentication**.

The response is a JSON document with this information:

- `versions` - An array of strings indicating the versions supported by this server.

Sample response:

{% highlight json %}
{
  "versions": ["{{ page.proto_version }}"]
}
{% endhighlight %}


### `GET /auth` ###

Requests to this endpoint require **no authentication**.

Requests to this endpoint must direct users to create new Setup Tokens.  How this is achieved is left up to the SimpleFIN Server.  Typically, the Browser will be redirected to a different URL.

Account Holders **should** be prompted for their Institution credentials prior to creating any Setup Tokens.

### `GET /accounts?id=<id>` ###

Requests to this endpoint **require authentication** as described below.

Parameters:

- `id` - A string identifier previously given out in a Setup Token.

Successful response will be a JSON-encoded Account Set (as described below).

If auth

## Authentication ##

### Setup Token ###

A Setup Token is generated by the SimpleFIN Server and delivered to a Consumer by the Account Holder (copy and paste).  It is a JWT signed with the `none` algorithm.  The body of the JWT contains the following:

- `url` - The SimpleFIN Server's Root Consumer URL.
- `secret` - A random string to be used as the secret for generating Access Tokens.
- `id` - A random string identifying a set of accounts for an Account Holder on the SimpleFIN Server.

For example, this:

{% highlight json %}
{
  "url": "https://example.com/simplefin",
  "secret": "6bb4da2b-9ac3-44e1-8328-9aa61d24cc79",
  "id": "a652be0a-21e5-4e6a-8db7-bd6c334e2aa6"
}
{% endhighlight %}

would be encoded as this Setup Token:

{% highlight text %}
eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJ1cmwiOiJodHRwczovL2V4YW1wbGUuY29tL3NpbXBsZWZpbiIsInNlY3JldCI6IjZiYjRkYTJiLTlhYzMtNDRlMS04MzI4LTlhYTYxZDI0Y2M3OSIsImlkIjoiYTY1MmJlMGEtMjFlNS00ZTZhLThkYjctYmQ2YzMzNGUyYWE2In0.
{% endhighlight %}


### Access Token ###

An Access Token is a short-lived token generated by a Consumer and used to authenticate with a SimpleFIN Server.  It is a JWT signed with the `HS256` algorithm using a `secret` from a Setup Token.  The body of the token contains this:

- `nonce` - A random string nonce.  Consumers **must not** reuse nonces.
- `exp` - (Expiration Time) A UNIX epoch timestamp indicating the time after which this token is no longer valid.  This **must be** within 60 seconds after `iat`.
- `iat` - (Issued At) A UNIX epoch timestamp indicating the time before which this token is not valid.  This **must be** within 60 seconds before `exp`.

For example, this:

{% highlight json %}
{
  "nonce": "b3342e92-4280-483a-856d-09e61b835112",
  "exp": 1435598230,
  "iat": 1435598290
}
{% endhighlight %}

would be encoded as this Access Token using the secret `"6bb4da2b-9ac3-44e1-8328-9aa61d24cc79"`:

{% highlight text %}
eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJub25jZSI6ImIzMzQyZTkyLTQyODAtNDgzYS04NTZkLTA5ZTYxYjgzNTExMiIsImlhdCI6MTQzNTU5ODI5MCwiZXhwIjoxNDM1NTk4MjMwfQ.7d8AAb-VUvcNC-sJiyVJI4HrdKHxF7tgm3q0OYeJI1Y
{% endhighlight %}

### HTTP Authentication ###

Consumers authenticate to SimpleFIN Servers by providing an Access Token as the value of the `Authentication` HTTP header in requests.

For example, using the Access Token from above, a Consumer could make an authenticated request to the `/accounts` endpoint using `curl` like this:

{% highlight bash %}
curl \
  -H 'Authentication: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJub25jZSI6ImIzMzQyZTkyLTQyODAtNDgzYS04NTZkLTA5ZTYxYjgzNTExMiIsImlhdCI6MTQzNTU5ODI5MCwiZXhwIjoxNDM1NTk4MjMwfQ.7d8AAb-VUvcNC-sJiyVJI4HrdKHxF7tgm3q0OYeJI1Y' \
  https://example.com/simplefin/accounts?id=a652be0a-21e5-4e6a-8db7-bd6c334e2aa6
{% endhighlight %}

The SimpleFIN Server **must**:

1. Verify the signature of the token using the secret associated with the `id`
2. Verify that `exp` is no more than 60 seconds after `iat`.
