---
layout: default
title: SimpleFIN Protocol
link_title: Protocol
last_modified: 2015-06-29
proto_version: "1.0-draft.1"
page_classes: protocol
---

Last updated: {{ page.last_modified }}

Version: {{ page.proto_version }}

The SimpleFIN standard defines:

1. [SimpleFIN HTTP protocol](#simplefin-http-protocol)
2. [SimpleFIN data format](#simplefin-data-format)
3. [Recommendations for token management](#recommendations)


# SimpleFIN HTTP Protocol #

## Players ##

Institution
:   This is a bank or other institution that people have accounts with.


SimpleFIN Server
:   An HTTP server operated by the Institution.  The SimpleFIN Server **must** require SSL for all communication with both the Account Holder and the Consumer.  Connection attempts not over SSL must be dropped -- they **must not** be redirected to SSL.


Account Holder
:   This is a person (or business) that has an account with the Institution.

Consumer
:   A Consumer is an application that connects to a SimpleFIN Server to retrieve financial information pertaining to an Account Holder.  The Consumer may be a hosted service or a locally-run application.  The Consumer **only** has read access to the SimpleFIN Server.  The Consumer **can not** alter the financial data on the SimpleFIN Server in any way.


## Overview ##

1. A Consumer directs an Account Holder to a SimpleFIN Server to obtain an Access Token.

2. The Account Holder exchanges their Institution credentials for a newly-generated Access Token.

3. The Account Holder gives the Access Token to the Consumer.

4. The Consumer stores the Access Token.

5. The Consumer gets financial data from the SimpleFIN Server using the Access Token.


## URLS ##

The SimpleFIN Server chooses a Root Consumer URL.  The SimpleFin Server must then implement the following standard endpoints as child resources to the Root Consumer URL:


### GET /info ###

This returns a JSON document with this information:

- `versions` - An array of strings indicating the versions supported by this server.


#### Authentication

None required.


#### Success response ####

{% highlight json %}
{
  "versions": ["{{ page.proto_version }}"]
}
{% endhighlight %}


### GET /auth ###

Requests to this endpoint must return a web page that will allow Account Holders to create new Setup Tokens.  The specifics are left up to the SimpleFIN Server.

#### Authentication

No SimpleFIN authentication is required.  Account Holders **should** be prompted for their Institution credentials prior to creating any Setup Tokens.





### GET /accounts ###

#### Authentication

HTTP Basic Authentication as described [below](#http-basic-authentication).

#### Response codes and content ####

- `200` - A successful response will be a JSON-encoded [Account Set](#account-set).
- `403` - Authentication failed.



## Authentication ##

### Access Token ###

An Access Token is generated by the SimpleFIN Server and delivered to a Consumer by the Account Holder (copy and paste).  It is a Base64 encoded URL with embedded credentials.  It follows this form:

{% highlight text %}
https://<user>:<secret>@<host>/<path>
{% endhighlight %}

where

- `user` - is a random string associated with a set of accounts (typically, a subset of an Account Holder's accounts).  This string **must not** be derived from any user data.  It **must** be random.
- `secret` - is a random string password for accessing the accounts.  This string **must not** be derived from any user data.  It **must** be random.
- `host` - the SimpleFIN Server hostname
- `path` - an optional path.

For example, this valid URL:

{% highlight text %}
https://abc:def@simplefin.org
{% endhighlight %}

would be encoded as this Access Token:

{% highlight text %}
aHR0cHM6Ly9hYmM6ZGVmQHNpbXBsZWZpbi5vcmc=
{% endhighlight %}


### HTTP Basic Authentication ###

Consumers authenticate to SimpleFIN Servers by using **HTTP Basic Authentication** with the credentials embedded in the decoded Access Token.  For example, using a Consumer using `curl` with the above credentials could access the `/accounts` endpoint with this command:

For example, using the Access Token from above, a Consumer could make an authenticated request to the `/accounts` endpoint using `curl` like this:

{% highlight bash %}
curl https://abc:def@simplefin.org
{% endhighlight %}

The SimpleFIN Server:

1. **Must** use Basic Authentication.
2. **Must** use HTTPS (SSL).
3. **Must drop** HTTP connections (non-SSL).


# SimpleFIN Data Format #

- Data is encoded as JSON strings.
- All attributes are required unless otherwise noted.

These objects are defined by SimpleFIN (more details below):

- [Organization](#organization)
- [Account](#account)
- [Transaction](#transaction)
- [Account Set](#account-set)


## Organization ##

{% highlight json %}
{
  "domain": "mybank.com",
  "sfin-url": "https://sfin.mybank.com"
}
{% endhighlight %}

{% for attr in site.data.sfindata.organization.attributes %}
`{{ attr.name }}`
:   *{{ attr.type }}*
    
    {% if attr.optional %}(OPTIONAL) {% endif %}
    {{ attr.description }}
    {% for example in attr.examples %}
    - `{{ example }}`
    {% endfor %}

{% endfor %}



## Account ##

{% highlight json %}
{
  "org": {
    "domain": "mybank.com",
    "sfin-url": "https://sfin.mybank.com"
  },
  "id": "2930002",
  "name": "Savings",
  "currency": "USD",
  "balance": "100.23",
  "available-balance": "75.23",
  "balance-date": "2001-01-01T09:22:33.2343",
  "transactions": [
    {
      "id": "AO334",
      "posted": "1995-02-17T23:56:12.22239",
      "amount": "-33293.43",
      "description": "Uncle Frank's Bait Shop",
    }
  ]
}
{% endhighlight %}

{% for attr in site.data.sfindata.account.attributes %}
`{{ attr.name }}`
:   *{{ attr.type }}*
    
    {% if attr.optional %}(OPTIONAL) {% endif %}
    {{ attr.description }}
    {% for example in attr.examples %}
    - `{{ example }}`
    {% endfor %}

{% endfor %}



## Transaction ##
{% highlight json %}
{
  "id": "12394832938403",
  "posted": 793090572,
  "amount": "-33293.43",
  "description": "Uncle Frank's Bait Shop",
}
{% endhighlight %}

{% for attr in site.data.sfindata.transaction.attributes %}
`{{ attr.name }}`
:   *{{ attr.type }}*
    
    {% if attr.optional %}(OPTIONAL) {% endif %}
    {{ attr.description }}
    {% for example in attr.examples %}
    - `{{ example }}`
    {% endfor %}

{% endfor %}


## Account Set ##
{% highlight json %}
{
  "accounts": [
    {
      "org": {
        "domain": "mybank.com",
        "sfin-url": "https://sfin.mybank.com"
      },
      "id": "2930002",
      "name": "Savings",
      "currency": "USD",
      "balance": "100.23",
      "available-balance": "75.23",
      "balance-date": 978366153,
      "transactions": []
    }
  ]
}
{% endhighlight %}

{% for attr in site.data.sfindata.accountset.attributes %}
`{{ attr.name }}`
:   *{{ attr.type }}*
    
    {% if attr.optional %}(OPTIONAL) {% endif %}
    {{ attr.description }}
    {% for example in attr.examples %}
    - `{{ example }}`
    {% endfor %}

{% endfor %}


# Recommendations #

It is *recommended* that Account Holders have the following abilities regarding Access Token management:

1. Users can associate user-provided names with tokens (e.g. "This is the token being used by example.com").
2. Users can create many tokens (for providing to multiple third party services).
3. Users can choose an expiration date for tokens when creating them.
4. Users can manually invalidate/expire existing tokens at will.  This is useful in the case of stolen tokens or abuse by third parties to whom tokens were given.

Additionally, consider the following when implementing a token management system:

1. It may be nice to notify users prior to token expiration.
2. It may be nice to allow users to temporarily disable all tokens and later re-enable them.  This can be used to prevent access while doing research into abuse.
3. Consider providing logging/audit information regarding token use, including the time tokens were used and the IPs from which requests came.
4. Allow tokens to be associated with a subset of available accounts.  For instance, allow the user to create one token for access to just their checking account, and another token for access to just their savings account.


<script src="/js/anchor.min.js"></script>
<script>
/**
 * AnchorJS v1.1.1 options and selector
 */

(function () {
  'use strict';

  anchors.options.placement = 'right';

  anchors.add('h1, h2, h3, h4, h5, h6, dt');

})();
</script>
